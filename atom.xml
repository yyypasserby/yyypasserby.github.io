<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>LearnByPractice</title>
  
  <subtitle>Practice makes Perfect</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://yyypasserby.github.io/"/>
  <updated>2018-07-20T21:36:39.926Z</updated>
  <id>https://yyypasserby.github.io/</id>
  
  <author>
    <name>Yiyun Yao</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Go Learning Notes</title>
    <link href="https://yyypasserby.github.io/2017/06/09/go-learning-notes/"/>
    <id>https://yyypasserby.github.io/2017/06/09/go-learning-notes/</id>
    <published>2017-06-10T06:09:33.000Z</published>
    <updated>2018-07-20T21:36:39.926Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Functions"><a href="#Functions" class="headerlink" title="Functions"></a>Functions</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">compute</span><span class="params">(fn <span class="keyword">func</span>(<span class="keyword">float64</span>, <span class="keyword">float64</span>)</span> <span class="title">float64</span>) <span class="title">float64</span></span> &#123;</span><br><span class="line"><span class="keyword">return</span> fn(<span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">hypot := <span class="function"><span class="keyword">func</span><span class="params">(x, y <span class="keyword">float64</span>)</span> <span class="title">float64</span></span> &#123;</span><br><span class="line"><span class="keyword">return</span> math.Sqrt(x*x + y*y)</span><br><span class="line">&#125;</span><br><span class="line">fmt.Println(hypot(<span class="number">5</span>, <span class="number">12</span>))</span><br><span class="line">fmt.Println(compute(hypot))</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">adder</span><span class="params">()</span> <span class="title">func</span><span class="params">(<span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">sum := <span class="number">0</span></span><br><span class="line"><span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(x <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">sum += x</span><br><span class="line"><span class="keyword">return</span> sum</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">pos, neg = adder(), adder()</span><br><span class="line">pos(<span class="number">2</span>) <span class="comment">// sum = 2</span></span><br><span class="line">neg(<span class="number">-2</span>) <span class="comment">// sum = -2</span></span><br></pre></td></tr></table></figure><ol><li>Types come after variables names</li><li>Only capitalized name will be exported</li><li>Consecutive variables with same type can share<br><code>x int, y int</code> -&gt; <code>x, y int</code></li><li>Functions can return multiple string using <code>(int, int)</code></li><li>Return variables can be named and used in the functions (must use parenthesis) <code>func Func(x int) (y int)</code></li><li>Naked return (using return statement without arguments in a function with return values) will return the named return variables. Not recommended in long functions.</li><li>Functions can also be passed as values</li><li>Functions have closures which can access variables outside itself, and different functions have different closures.</li></ol><h2 id="Variables"><a href="#Variables" class="headerlink" title="Variables"></a>Variables</h2><ol><li>Variables can have initializer through <code>=</code>, if given, type can be omitted</li><li><code>:=</code> is a short assignment, which can be used where <code>var</code> and type omitted</li><li><code>fmt.Printf(&quot;Type: %T Value: %v\n&quot;, z, z)</code></li><li><code>const</code> variable has very high precision.</li></ol><h2 id="Packages"><a href="#Packages" class="headerlink" title="Packages"></a>Packages</h2><ol><li>Import name is the last word of the package</li><li>You should make all the import names unique, if it is not, using like <code>othername &quot;path/to/conflictname&quot;</code></li></ol><h2 id="Control-Flow"><a href="#Control-Flow" class="headerlink" title="Control Flow"></a>Control Flow</h2><ol><li>In <code>if</code> and <code>for</code>, <code>{}</code> is always required, <code>()</code> is always not needed</li><li>No <code>while</code>, only <code>for $condition {}</code></li><li>Like <code>for</code>, <code>if</code> and <code>switch</code> can have a short statement, and the variables declared can only be used until the end of <code>if</code> or <code>else</code></li><li>No need to break in <code>switch</code>, it will stop when hits</li><li><code>switch</code> with no condition is equivalent to <code>switch true</code></li><li><code>defer</code> defers the execution of a function until the surrounding function returns, but only the function call, the arguments are evaluated immediately</li><li>Multiple <code>defer</code>s goes into a stack, when function returns, it will pop out in a LIFO order</li></ol><h2 id="Pointers"><a href="#Pointers" class="headerlink" title="Pointers"></a>Pointers</h2><ol><li>No pointer arithmetic</li><li>Pointer to a struct: <code>p.X = 1</code> instead of <code>(*p).X = 1</code></li></ol><h2 id="Types"><a href="#Types" class="headerlink" title="Types"></a>Types</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Vertex <span class="keyword">struct</span> &#123;</span><br><span class="line">X, Y <span class="keyword">float64</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">v := Vertex&#123;<span class="number">3</span>, <span class="number">4</span>&#125;</span><br><span class="line"><span class="comment">// v: = Vertex&#123;X: 1&#125; // Y: 0 is implicit</span></span><br><span class="line">p := &amp;Vertex&#123;<span class="number">3</span>, <span class="number">4</span>&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(v Vertex)</span> <span class="title">Abs</span><span class="params">()</span> <span class="title">float64</span></span> &#123;</span><br><span class="line"><span class="keyword">return</span> math.Sqrt(v.X*v.X + v.Y*v.Y)</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(v *Vertex)</span> <span class="title">Scale</span><span class="params">(f <span class="keyword">float64</span>)</span></span> &#123;</span><br><span class="line">v.X = v.X * f</span><br><span class="line">v.Y = v.Y * f</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">v.Scale(<span class="number">10</span>) <span class="comment">// v.X = 30, v.Y = 40</span></span><br><span class="line">v.Abs() <span class="comment">// 50</span></span><br></pre></td></tr></table></figure><ol><li>Go doesn’t have classes, but types with methods</li><li>Methods is just functions with a receiver</li><li>Methods can declared on non-struct type, like <code>type Myfloat float64</code></li><li>You can just declare methods with a receiver whose type is defined in the same pacakage as the method</li><li>Methods’ receiver can also be pointers, and only methods with pointer receivers can modify the value to which the receiver points.</li><li>Methods with pointer receivers can accept both pointers and values</li><li>In the inverse direction, methods with value receivers can also accept both pointers and values(Remember both can’t modify the field in that type)</li></ol><h2 id="Interface"><a href="#Interface" class="headerlink" title="Interface"></a>Interface</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> I <span class="keyword">interface</span> &#123;</span><br><span class="line">M()</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">type</span> T <span class="keyword">struct</span> &#123;</span><br><span class="line">S <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// This method means type T implements the interface I,</span></span><br><span class="line"><span class="comment">// but we don't need to explicitly declare that it does so.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t T)</span> <span class="title">M</span><span class="params">()</span></span> &#123;</span><br><span class="line">fmt.Println(t.S)</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">do</span><span class="params">(i <span class="keyword">interface</span>&#123;&#125;)</span></span> &#123;</span><br><span class="line"><span class="keyword">switch</span> v := i.(<span class="keyword">type</span>) &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="keyword">int</span>:</span><br><span class="line">fmt.Printf(<span class="string">"Twice %v is %v\n"</span>, v, v*<span class="number">2</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="keyword">string</span>:</span><br><span class="line">fmt.Printf(<span class="string">"%q is %v bytes long\n"</span>, v, <span class="built_in">len</span>(v))</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">fmt.Printf(<span class="string">"I don't know about type %T!\n"</span>, v)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> a I = T&#123;<span class="string">"hello"</span>&#125;</span><br><span class="line">a.M()</span><br><span class="line"> </span><br><span class="line"><span class="keyword">var</span> i <span class="keyword">interface</span>&#123;&#125; = <span class="string">"hello"</span></span><br><span class="line">s := i.(<span class="keyword">string</span>)</span><br><span class="line">fmt.Println(s)</span><br><span class="line">s, ok := i.(<span class="keyword">string</span>)</span><br><span class="line">fmt.Println(s, ok)</span><br><span class="line">f, ok := i.(<span class="keyword">float64</span>)</span><br><span class="line">fmt.Println(f, ok)</span><br><span class="line">f = i.(<span class="keyword">float64</span>) <span class="comment">// panic</span></span><br><span class="line">fmt.Println(f)</span><br><span class="line"> </span><br><span class="line"><span class="comment">// error code</span></span><br><span class="line">inte, err := strconv.Atoi(<span class="string">"42"</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">    fmt.Printf(<span class="string">"couldn't convert number: %v\n"</span>, err)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">fmt.Println(<span class="string">"Converted integer:"</span>, inte)</span><br><span class="line"> </span><br><span class="line"><span class="comment">// reader</span></span><br><span class="line">r := strings.NewReader(<span class="string">"Hello, Reader!"</span>)</span><br><span class="line">b := <span class="built_in">make</span>([]<span class="keyword">byte</span>, <span class="number">8</span>)</span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line">n, err := r.Read(b)</span><br><span class="line">fmt.Printf(<span class="string">"n = %v err = %v b = %v\n"</span>, n, err, b)</span><br><span class="line">fmt.Printf(<span class="string">"b[:n] = %q\n"</span>, b[:n])</span><br><span class="line"><span class="keyword">if</span> err == io.EOF &#123;</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>A interface method is defined as a set of method signature, and can hold any value that implements those methods</li><li>If the concrete value inside an interface is <code>nil</code>, the receiver in the method will be <code>nil</code></li><li>Interface with zero methods are called empty interface, which are used to handle values of unknown types</li><li>A <code>Stringer</code> is a type that can describe itself as a string. The <code>fmt</code> package look for this interface to print values</li><li>Functions often return <code>error</code> value, and calling code should handle errors by testing whether the error equals <code>nil</code></li></ol><h2 id="Array"><a href="#Array" class="headerlink" title="Array"></a>Array</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a [<span class="number">10</span>]<span class="keyword">int</span> <span class="comment">// [n]T is an array of n values of T, and it will give you ten 0s</span></span><br><span class="line"><span class="keyword">var</span> s []<span class="keyword">int</span> = a[<span class="number">1</span>:<span class="number">5</span>] <span class="comment">// []T is a slice of an array</span></span><br><span class="line"><span class="keyword">var</span> as []<span class="keyword">int</span> = a[<span class="number">1</span>:] <span class="comment">// a[5:]</span></span><br><span class="line"> </span><br><span class="line">ma := <span class="built_in">make</span>([]<span class="keyword">int</span>, <span class="number">0.</span> <span class="number">5</span>) <span class="comment">// len(ma)=0, cap(ma)=5</span></span><br><span class="line"><span class="comment">// Create a tic-tac-toe board.</span></span><br><span class="line"> </span><br><span class="line">board := [][]<span class="keyword">string</span>&#123;</span><br><span class="line">[]<span class="keyword">string</span>&#123;<span class="string">"_"</span>, <span class="string">"_"</span>, <span class="string">"_"</span>&#125;,</span><br><span class="line">[]<span class="keyword">string</span>&#123;<span class="string">"_"</span>, <span class="string">"_"</span>, <span class="string">"_"</span>&#125;,</span><br><span class="line">[]<span class="keyword">string</span>&#123;<span class="string">"_"</span>, <span class="string">"_"</span>, <span class="string">"_"</span>&#125;,</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// The players take turns.</span></span><br><span class="line">board[<span class="number">0</span>][<span class="number">0</span>] = <span class="string">"X"</span></span><br><span class="line">board[<span class="number">2</span>][<span class="number">2</span>] = <span class="string">"O"</span></span><br><span class="line">board[<span class="number">1</span>][<span class="number">2</span>] = <span class="string">"X"</span></span><br><span class="line">board[<span class="number">1</span>][<span class="number">0</span>] = <span class="string">"O"</span></span><br><span class="line">board[<span class="number">0</span>][<span class="number">2</span>] = <span class="string">"X"</span></span><br><span class="line"><span class="built_in">append</span>(as, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>) <span class="comment">// add &#123;1, 2, 3&#125; to slice as</span></span><br></pre></td></tr></table></figure><ol><li>Slices are like references to arrays</li><li>Slices can’t exist individually, if you build a slice, you build an array and create a slice referenced to it</li><li>Slices have both length <code>len(s)</code> and capacity <code>cap(s)</code>. If you change the back, the capacity will always maintain; but if you change the front the capacity will decrease, but anytime slices can’t exceed the capacity which means you can re-slice it</li><li>If a slice reference to no array, it has 0 in both length and capacity, and also it equals to <code>nil</code></li><li><code>range</code> returns index and value for array in <code>for</code> and value can be dropped by not declaring it</li></ol><h2 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> m = <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span> &#123;</span><br><span class="line"><span class="string">"Debug"</span>: <span class="string">"sucks"</span>,</span><br><span class="line"><span class="string">"Test"</span> : <span class="string">"rocks"</span>,</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">v, ok := m[<span class="string">"Test"</span>] <span class="comment">// v = "rocks", ok = True</span></span><br><span class="line">v, ok = m[<span class="string">"Deploy"</span>] <span class="comment">// v = "", ok = False</span></span><br><span class="line">m[<span class="string">"Deploy"</span>] = <span class="string">"rocks"</span></span><br><span class="line"><span class="built_in">delete</span>(m, <span class="string">"Deploy"</span>)</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">WordCount</span><span class="params">(s <span class="keyword">string</span>)</span> <span class="title">map</span>[<span class="title">string</span>]<span class="title">int</span></span> &#123;</span><br><span class="line">ret := <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">int</span> &#123;&#125;</span><br><span class="line">fields := strings.Fields(s)</span><br><span class="line"><span class="keyword">for</span> _, field := <span class="keyword">range</span> fields &#123;</span><br><span class="line">v, ok := ret[field]</span><br><span class="line"><span class="keyword">if</span> ok == <span class="literal">true</span> &#123;</span><br><span class="line">ret[field] = v + <span class="number">1</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">ret[field] = <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ret</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Goroutines"><a href="#Goroutines" class="headerlink" title="Goroutines"></a>Goroutines</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">go</span> f(x, y, z)</span><br><span class="line">ch &lt;- v <span class="comment">// Send v to channel ch.</span></span><br><span class="line">v := &lt;-ch <span class="comment">// Receive from ch, and assign value to v.</span></span><br><span class="line">ch := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>, <span class="number">1</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment">// close and range</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">fibonacci</span><span class="params">(n <span class="keyword">int</span>, c <span class="keyword">chan</span> <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">x, y := <span class="number">0</span>, <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">c &lt;- x</span><br><span class="line">x, y = y, x+y</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">close</span>(c)</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">c := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>, <span class="number">10</span>)</span><br><span class="line"><span class="keyword">go</span> fibonacci(<span class="built_in">cap</span>(c), c)</span><br><span class="line"><span class="keyword">for</span> i := <span class="keyword">range</span> c &#123;</span><br><span class="line">fmt.Println(i)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// select</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">fibonacci</span><span class="params">(c, quit <span class="keyword">chan</span> <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">x, y := <span class="number">0</span>, <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line"><span class="keyword">select</span> &#123;</span><br><span class="line"><span class="keyword">case</span> c &lt;- x:</span><br><span class="line">x, y = y, x+y</span><br><span class="line"><span class="keyword">case</span> &lt;-quit:</span><br><span class="line">fmt.Println(<span class="string">"quit"</span>)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">c := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>)</span><br><span class="line">quit := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>)</span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">fmt.Println(&lt;-c)</span><br><span class="line">&#125;</span><br><span class="line">quit &lt;- <span class="number">0</span></span><br><span class="line">&#125;()</span><br><span class="line">fibonacci(c, quit)</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// SafeCounter is safe to use concurrently.</span></span><br><span class="line"><span class="keyword">type</span> SafeCounter <span class="keyword">struct</span> &#123;</span><br><span class="line">v   <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">int</span></span><br><span class="line">mux sync.Mutex</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// Inc increments the counter for the given key.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *SafeCounter)</span> <span class="title">Inc</span><span class="params">(key <span class="keyword">string</span>)</span></span> &#123;</span><br><span class="line">c.mux.Lock()</span><br><span class="line"><span class="comment">// Lock so only one goroutine at a time can access the map c.v.</span></span><br><span class="line">c.v[key]++</span><br><span class="line">c.mux.Unlock()</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// Value returns the current value of the counter for the given key.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *SafeCounter)</span> <span class="title">Value</span><span class="params">(key <span class="keyword">string</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">c.mux.Lock()</span><br><span class="line"><span class="comment">// Lock so only one goroutine at a time can access the map c.v.</span></span><br><span class="line"><span class="keyword">defer</span> c.mux.Unlock()</span><br><span class="line"><span class="keyword">return</span> c.v[key]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li><code>goroutine</code> is a lightweight thread managed by the Go routine, <code>go func(x)</code></li><li>Channels are a typed conduit through which you can send and receive values with the channel operator, <code>&lt;-</code></li><li>Like Maps and slices, channels must be created before use, <code>ch := make(chan int)</code></li><li>By default, sends and receives block until the other side is ready. This allows gorountines to synchronize without explicit locks or condition variables</li><li>A sender can <code>close(ch)</code> a channel to indicate that no more value will be sent. And the receivers can use the second parameter to test whether the channel has been closed, <code>v, ok := &lt;-ch</code></li><li>The loop, <code>for x := range ch {}</code> for the channel will repeat until it is closed.</li><li>In <code>select</code>, <code>default</code> means non-blocking</li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;Functions&quot;&gt;&lt;a href=&quot;#Functions&quot; class=&quot;headerlink&quot; title=&quot;Functions&quot;&gt;&lt;/a&gt;Functions&lt;/h2&gt;&lt;figure class=&quot;highlight go&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td c
      
    
    </summary>
    
      <category term="practice" scheme="https://yyypasserby.github.io/categories/practice/"/>
    
    
      <category term="golang" scheme="https://yyypasserby.github.io/tags/golang/"/>
    
  </entry>
  
  <entry>
    <title>My Setup</title>
    <link href="https://yyypasserby.github.io/2017/05/31/my-setup/"/>
    <id>https://yyypasserby.github.io/2017/05/31/my-setup/</id>
    <published>2017-05-31T18:22:33.000Z</published>
    <updated>2018-07-20T23:07:40.375Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Oh-My-Zsh"><a href="#Oh-My-Zsh" class="headerlink" title="Oh My Zsh"></a>Oh My Zsh</h2><p><a href="https://github.com/robbyrussell/oh-my-zsh" target="_blank" rel="noopener">https://github.com/robbyrussell/oh-my-zsh</a></p><h3 id="Install"><a href="#Install" class="headerlink" title="Install"></a>Install</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sh -c <span class="string">"<span class="variable">$(curl -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh)</span>"</span></span><br><span class="line">brew install autojump</span><br></pre></td></tr></table></figure><h5 id="Installation-Permission-Problem"><a href="#Installation-Permission-Problem" class="headerlink" title="Installation Permission Problem"></a>Installation Permission Problem</h5><p>(Github)[<a href="https://github.com/Homebrew/brew/issues/3228]" target="_blank" rel="noopener">https://github.com/Homebrew/brew/issues/3228]</a></p><h3 id="Configure"><a href="#Configure" class="headerlink" title="Configure"></a>Configure</h3><p>Add following lines to <code>.zshrc</code></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">plugins=(git cpp autojump osx)</span><br><span class="line">[[ -s ~/.autojump/etc/profile.d/autojump.sh ]] &amp;&amp; . ~/.autojump/etc/profile.d/autojump.sh</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ <span class="string">"<span class="variable">$TERM_PROGRAM</span>"</span> == <span class="string">"nuclide"</span> ]]; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">export</span> EDITOR=<span class="string">'atom --wait'</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  <span class="built_in">export</span> EDITOR=vim <span class="comment"># your favorite editor here</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><h4 id="zsh-autosuggestions"><a href="#zsh-autosuggestions" class="headerlink" title="zsh-autosuggestions"></a><a href="https://github.com/zsh-users/zsh-autosuggestions" target="_blank" rel="noopener">zsh-autosuggestions</a></h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> git://github.com/zsh-users/zsh-autosuggestions <span class="variable">$ZSH_CUSTOM</span>/plugins/zsh-autosuggestions</span><br></pre></td></tr></table></figure><p>Add following lines to <code>.zshrc</code></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plugins=(zsh-autosuggestions)</span><br></pre></td></tr></table></figure><h2 id="Oh-My-Tmux"><a href="#Oh-My-Tmux" class="headerlink" title="Oh My Tmux"></a>Oh My Tmux</h2><p><a href="https://github.com/gpakosz/.tmux" target="_blank" rel="noopener">https://github.com/gpakosz/.tmux</a></p><h3 id="Install-1"><a href="#Install-1" class="headerlink" title="Install"></a>Install</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/gpakosz/.tmux.git</span><br><span class="line">ln -s -f .tmux/.tmux.conf</span><br><span class="line">cp .tmux/.tmux.conf.local .</span><br><span class="line">tmux <span class="built_in">source</span>-file ~/.tmux.conf</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tls=&apos;tmux ls&apos;</span><br><span class="line">tat=&apos;tmux attach -t&apos;</span><br><span class="line">trn=&apos;tmux rename&apos;</span><br></pre></td></tr></table></figure><h2 id="spf13-vim"><a href="#spf13-vim" class="headerlink" title="spf13-vim"></a>spf13-vim</h2><p><a href="https://github.com/spf13/spf13-vim" target="_blank" rel="noopener">https://github.com/spf13/spf13-vim</a></p><h3 id="Download"><a href="#Download" class="headerlink" title="Download"></a>Download</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl https://j.mp/spf13-vim3 -L &gt; spf13-vim.sh &amp;&amp; sh spf13-vim.sh</span><br></pre></td></tr></table></figure><h3 id="Install-2"><a href="#Install-2" class="headerlink" title="Install"></a>Install</h3><p>Open vim and run</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:PluginInstall</span><br></pre></td></tr></table></figure><h3 id="Configure-1"><a href="#Configure-1" class="headerlink" title="Configure"></a>Configure</h3><p>Modify <code>.vimrc.bundles</code></p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">g:spf13_bundle_groups</span>=[<span class="string">'general'</span>, <span class="string">'writing'</span>, <span class="string">'youcompleteme'</span>, <span class="string">'programming'</span>, <span class="string">'python'</span>, <span class="string">'javascript'</span>, <span class="string">'html'</span>, <span class="string">'misc'</span>,]</span><br></pre></td></tr></table></figure><p>Install YouCompleteMe (cpp &amp; javascript)</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/.vim/bundle/YouCompleteMe</span><br><span class="line">./install.py --clang-completer</span><br><span class="line">./install.py --tern-completer</span><br></pre></td></tr></table></figure><p>Add settings for YouCompleteMe in <code>.vimrc.local</code></p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">g:ycm_global_ycm_extra_conf</span> = <span class="string">"~/.vim/.ycm_extra_conf.py"</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:ycm_confirm_extra_conf</span> = <span class="number">0</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:ycm_seed_identifiers_with_syntax</span> = <span class="number">1</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:ycm_collect_identifiers_from_tag_files</span> = <span class="number">1</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:ycm_min_num_of_chars_for_completion</span> = <span class="number">1</span></span><br><span class="line"><span class="keyword">set</span> completeopt=longest,<span class="keyword">menu</span></span><br></pre></td></tr></table></figure><p>Get <code>.ycm_extra_conf.py</code></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span></span><br><span class="line">wget https://raw.githubusercontent.com/Valloric/ycmd/master/cpp/ycm/.ycm_extra_conf.py</span><br></pre></td></tr></table></figure><p>Add the path under <code>include &lt;...&gt;</code> to the <code>.ycm_extra_conf.py</code> with <code>-isystem</code></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> | clang -v -E -x c++ -</span><br></pre></td></tr></table></figure><p>Open vim and restart YcmServer</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:YcmRestartServer</span><br></pre></td></tr></table></figure><h4 id="optional-Add-google-vim-codefmt"><a href="#optional-Add-google-vim-codefmt" class="headerlink" title="[optional] Add google/vim-codefmt"></a>[optional] Add <a href="https://github.com/google/vim-codefmt" target="_blank" rel="noopener">google/vim-codefmt</a></h4><p>Add plugins to <code>.vimrc.bundles.local</code> and run <code>:PluginInstall</code></p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Plugin <span class="string">'google/vim-maktaba'</span></span><br><span class="line">Plugin <span class="string">'google/vim-codefmt'</span></span><br><span class="line">Plugin <span class="string">'google/vim-glaive'</span></span><br></pre></td></tr></table></figure><p>Add settings to <code>.vimrc.local</code></p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">call</span> glaive#Install()</span><br><span class="line">Glaive codefmt plugin[mappings]</span><br><span class="line">Glaive codefmt google_java_executable=<span class="string">"java -jar /path/to/google-java-format-VERSION-all-deps.jar"</span></span><br><span class="line">Glaive codefmt clang_format_style=<span class="string">"google"</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">augroup</span> autoformat_settings</span><br><span class="line">  <span class="keyword">autocmd</span> FileType bzl AutoFormatBuffer buildifier</span><br><span class="line">  <span class="keyword">autocmd</span> FileType <span class="keyword">c</span>,cpp,proto,javascript AutoFormatBuffer clang-format</span><br><span class="line">  <span class="keyword">autocmd</span> FileType dart AutoFormatBuffer dartfmt</span><br><span class="line">  <span class="keyword">autocmd</span> FileType <span class="keyword">go</span> AutoFormatBuffer gofmt</span><br><span class="line">  <span class="keyword">autocmd</span> FileType gn AutoFormatBuffer gn</span><br><span class="line">  <span class="keyword">autocmd</span> FileType html,css,json AutoFormatBuffer js-beautify</span><br><span class="line">  <span class="keyword">autocmd</span> FileType java AutoFormatBuffer google-java-format</span><br><span class="line">  <span class="keyword">autocmd</span> FileType <span class="keyword">python</span> AutoFormatBuffer yapf</span><br><span class="line">  <span class="comment">" Alternative: autocmd FileType python AutoFormatBuffer autopep8</span></span><br><span class="line"><span class="keyword">augroup</span> END</span><br><span class="line"> </span><br><span class="line"><span class="comment">" vim-javascript</span></span><br><span class="line"><span class="keyword">autocmd</span> Filetype javascript <span class="keyword">setlocal</span> <span class="keyword">ts</span>=<span class="number">2</span> <span class="keyword">sts</span>=<span class="number">2</span> <span class="keyword">sw</span>=<span class="number">2</span></span><br></pre></td></tr></table></figure><p>Unbind existing key mapping of <code>&lt;Leader&gt;=</code> in <code>.vimrc</code></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;Oh-My-Zsh&quot;&gt;&lt;a href=&quot;#Oh-My-Zsh&quot; class=&quot;headerlink&quot; title=&quot;Oh My Zsh&quot;&gt;&lt;/a&gt;Oh My Zsh&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/robbyrussell/o
      
    
    </summary>
    
      <category term="setup" scheme="https://yyypasserby.github.io/categories/setup/"/>
    
    
      <category term="zsh" scheme="https://yyypasserby.github.io/tags/zsh/"/>
    
      <category term="tmux" scheme="https://yyypasserby.github.io/tags/tmux/"/>
    
      <category term="vim" scheme="https://yyypasserby.github.io/tags/vim/"/>
    
  </entry>
  
  <entry>
    <title>Practices and Skills from NPM to Angular</title>
    <link href="https://yyypasserby.github.io/2015/06/03/npm-yo-grunt-bower-angular/"/>
    <id>https://yyypasserby.github.io/2015/06/03/npm-yo-grunt-bower-angular/</id>
    <published>2015-06-03T18:22:33.000Z</published>
    <updated>2018-07-20T21:36:39.927Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/npm-yo-grunt-bower-angular/angular.jpg" alt="AngularJS"></p><p>Recently, I am refactorying some of my projects. It may be more proper to say that the projects were rewritten because I have update the technical solutions that is much cooler.</p><p>In this blog, I am going to talk about some obstacles I met in building an <a href="https://angularjs.org/" target="_blank" rel="noopener">Angular</a> App and how I solve them. This will not contain real coding technics in how to write an app, but some useful tools or components that may help to write Angular more comfortably and conveniently.</p><p>Ok, let’s just begin with how to design the project structure of Angular.</p><p>Angular can be used in many ways, it provides a lot of useful functions and directives for you to build a web application, which also means Angular is somewhat heavier than other framework. It mainly solves some key problems in the web front-end development, like modules, customizing tags and etc., and assembles all these solutions into a big framework. Consequently, you can use Angular to render your web page and use controllers to bind your data, just like the old ways, or you may define your own directives and services to build an web app in a new way. If you are the second-way supporter, I’m going to talk about a good way to structure your apps.</p><p>The main tools we will use next: npm, yo, grunt, bower, angular-generator.</p><h2 id="npm"><a href="#npm" class="headerlink" title="npm"></a>npm</h2><p><a href="https://github.com/npm/npm" target="_blank" rel="noopener">npm</a> is an amazing tool for you if your project is related to <code>Javascript</code>. With the development of <code>Javascript</code>, npm is also becoming more widely used in development. But this time, it is just a tool installer, we will just use it to prepare the tool for our app.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g grunt-cli bower yo generator-karma generator-angular</span><br></pre></td></tr></table></figure><p><code>-g</code> means that you are going to install these package in a global scope. You can also remove this option, however, I really recommend you to add it because these are all tools which we will use next, even in the future when you need to build an Angular App and they will not contaminate the namespace between the projects.</p><p>If you decide to install it in a global scope, it is helpful to customize the directory to store the global resources.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm <span class="built_in">set</span> config prefix path/to/your/directory/[node-global]</span><br><span class="line">npm <span class="built_in">set</span> config cache path/to/your/directory/[node-cache]</span><br></pre></td></tr></table></figure><p><code>[]</code> means you can do in that way to organize your npm global directory and I think it is elegant. You could also find the configuration file <code>~/.npmrc</code> and define these in it.</p><p>The installation process may be very slow in China. You could use an <a href="http://npm.taobao.org/" target="_blank" rel="noopener">npm mirror</a> maintained by Taobao to improve the speed.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">registry=https://registry.npm.taobao.org/</span><br></pre></td></tr></table></figure><h2 id="yo-amp-generator-karma-amp-generator-angular"><a href="#yo-amp-generator-karma-amp-generator-angular" class="headerlink" title="yo &amp; generator-karma &amp; generator-angular"></a>yo &amp; generator-karma &amp; generator-angular</h2><p><a href="http://yeoman.io/" target="_blank" rel="noopener">Yeoman</a> is a tool to give you an easy way to build a basic structure for the application. It predefines some kinds of structure of a particular app. <a href="https://github.com/yeoman/generator-karma" target="_blank" rel="noopener">generator-karma</a> and <a href="https://github.com/yeoman/generator-angular" target="_blank" rel="noopener">generator-angular</a> are those predefined structures and they are also need to be installed.</p><p><a href="http://karma-runner.github.io/0.12/index.html" target="_blank" rel="noopener">Karma</a> is a JS unit-test framework. You can define some test in the karma.conf.js and run <code>karma start karma.conf.js</code> to make a automatic test for your app. It is especiallly useful when your project is based on some big frameworks like Angular, because it can test every small module you define like a directve, a filter or a controller, and you can integrate your web app continuously and errorlessly. Also it can be registered in a <strong>grunt task</strong> which can be executed automatically once you want to commit a version.</p><p>These two generator not only create a directory structure for each of their frameworks. It also defines what needs to be involved in this project. </p><p>Let’s use Angular as an example. When you finishes installing the yo and angular-generator, you can now set out to build an Angular App.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir angular-app</span><br><span class="line"><span class="built_in">cd</span> angular-app</span><br><span class="line">yo angular</span><br></pre></td></tr></table></figure><p>After, you can set some setting to your angular project. Yo will automactically download the dependencies by <code>bower</code> and inject them in your project using wiredep by <code>grunt</code>. Also some framework like <code>karma</code> mentioned above will be installed.</p><p>yo &amp; angular-generator also do other awesomethings. It will organize the project even you are going to add something to it, like if you are going to add an filter to this app.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yo angular:filter your_filter_name</span><br></pre></td></tr></table></figure><p>Yo will create a directory in your <code>scripts</code> directory and create a file named <code>your_filter_name.js</code> in it. This filter will also be inject into your <code>index.html</code> automatically using <code>wiredep</code>. You have to pay attention to your filter name, <code>-</code> based and customized prefix is recommended. For example,</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yo angular:directive my-quiz-directive</span><br></pre></td></tr></table></figure><p>A <code>my-quiz-directive.js</code> file will be created and a <code>myQuizDirective</code> directive will be added to Angular. So <code>my-quiz-directive</code> can be used in html like <code>&lt;my-quiz-directive&gt;&lt;/my-quiz-directive&gt;</code> or other Angular recommended ways.</p><h2 id="bower"><a href="#bower" class="headerlink" title="bower"></a>bower</h2><p>There is not much to talk about <a href="http://bower.io/" target="_blank" rel="noopener">bower</a>. It is first introduced in this <a href="{filename}/2014-12-18-django-and-bower.md">blog</a>. In the Angular app generated by yo, only one thing need to be carefully maintained, <code>bower.json</code>. If you want to use the <code>wiredep</code> to automate your project dependency, every time your installed a library or a framework by bower, you must use <code>--save</code> option to update the <code>bower.json</code> file, and the grunt will watch the change of <code>bower.json</code> and inject all the dependency in it to the <code>index.html</code></p><h2 id="grunt"><a href="#grunt" class="headerlink" title="grunt"></a>grunt</h2><p><a href="http://gruntjs.com/" target="_blank" rel="noopener">grunt</a> is an automator in web front-end development.</p><h3 id="Why-we-need-an-automator"><a href="#Why-we-need-an-automator" class="headerlink" title="Why we need an automator?"></a>Why we need an automator?</h3><p>After several years of exploration in web dev, engineers find many best practices in web front-end dev, including some effort to do with performance and some with engineering. And all these tasks like test, wiredep, cssmin, htmlmin, uglify, all can be done automatically. So we just need a way to define how it works and then let a program does it for us.</p><p>grunt is that kind of thing. Also <a href="http://gulpjs.com/" target="_blank" rel="noopener">gulp</a> can do the same thing, but lighter.</p><p>You can define the tasks in <code>Gruntfile.js</code>, most of the tasks you need is already predefined in grunt, so you just need to call them by name.</p><p>Talking about our app, the basic tasks generated automactically by yo are following in my space:</p><ul><li>clean</li><li>wiredep</li><li>useminPrepare</li><li>concurrent</li><li>autoprefixer</li><li>concat</li><li>ngAnnotate</li><li>copy</li><li>cdnify</li><li>cssmin</li><li>uglify</li><li>filerev</li><li>usemin</li><li>htmlmin</li><li>karma</li><li>jshint</li><li>watch</li></ul><p>You can reorganize these module into tasks and call them.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grunt task_name</span><br></pre></td></tr></table></figure><p>Several changes I made to the default <code>Gruntfile.js</code>:</p><h4 id="Add-ignore-symbols-to-jshint"><a href="#Add-ignore-symbols-to-jshint" class="headerlink" title="Add ignore symbols to jshint"></a>Add ignore symbols to jshint</h4><p><a href="http://jshint.com/" target="_blank" rel="noopener">jshint</a> is to check the correctness of your js code. However, you may find some warnings when you run jshint, this may abort the whole grunt tasks if you do not add <code>--force</code> options. You can modify <code>.jshintrc</code> file in the current project directory and add your symbols ignored by the jshint.</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"globals"</span>: &#123;</span><br><span class="line">        <span class="attr">"angular"</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">"$"</span>: <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>This means <code>angular</code> and <code>$</code> symbols will be ignored when checking the js syntax.</p><h4 id="Add-css-dependent-resources-copied"><a href="#Add-css-dependent-resources-copied" class="headerlink" title="Add css-dependent resources copied"></a>Add css-dependent resources copied</h4><p>When you use some front-end framework like <a href="http://getbootstrap.com/" target="_blank" rel="noopener">bootstrap</a>, you may encounter some problems like web page cannot locate the image resources. That is because in the production environment the theme will be copied, only css and js. So you must modify the gruntfile.</p><p>This action is provided by the <code>copy</code> module in <code>grunt</code>.</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    expand: true,</span><br><span class="line">    dot: true,</span><br><span class="line">    cwd: 'path/to/your/cwd',</span><br><span class="line">    dest: 'path/to/your/dest',</span><br><span class="line">    src: ['paths/to/your/src']</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>You can add above structure to the <code>copy:dist:files</code> in <code>Gruntfile.js</code>, add the all the srcs your defined in <code>path/to/your/cwd/paths/to/your/src</code> will be copied to <code>path/to/your/dest/paths/to/your/src</code>.</p><h4 id="Remove-dynamic-image-path-from-Filerev"><a href="#Remove-dynamic-image-path-from-Filerev" class="headerlink" title="Remove dynamic image path from Filerev"></a>Remove dynamic image path from Filerev</h4><p>Filerev is to renames files for browser caching purposes. However, if you have some image path is dynamically rendered by the attribute defined by user, it should be excluded.</p><p>This function is provided by <code>filerev</code> module in grunt.</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">filerev: &#123;</span><br><span class="line">    dist: &#123;</span><br><span class="line">    src: [</span><br><span class="line">        '&lt;%= yeoman.dist %&gt;/scripts/&#123;,*/&#125;*.js',</span><br><span class="line">        '&lt;%= yeoman.dist %&gt;/styles/&#123;,*/&#125;*.css',</span><br><span class="line">        '&lt;%= yeoman.dist %&gt;/images/&#123;,*/&#125;*.&#123;png,jpg,jpeg,gif,webp,svg&#125;',</span><br><span class="line">        '&lt;%= yeoman.dist %&gt;/styles/fonts/*'</span><br><span class="line">    ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>You need to remove the src from it or redefine the static resources path for browser caching purposes.</p><h4 id="Test-modification"><a href="#Test-modification" class="headerlink" title="Test modification"></a>Test modification</h4><p>If you use the yo way to create directives, your test case is also generated in the <code>test</code> directory. Consequently, you should write your own test cases, not <code>awesomeThings</code> any more. :-)</p><p>Also some modules which need not to be tested should be remove in <code>karma.conf.js</code>.</p><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>With all the tools, to me, I feel like I have a commandline-based IDE. Also if you preferred a GUI-way to develop, you can choose many other <strong>real</strong> IDE, like <a href="https://www.jetbrains.com/webstorm/" target="_blank" rel="noopener">Webstorm</a>.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;/images/npm-yo-grunt-bower-angular/angular.jpg&quot; alt=&quot;AngularJS&quot;&gt;&lt;/p&gt;
&lt;p&gt;Recently, I am refactorying some of my projects. It may
      
    
    </summary>
    
      <category term="web" scheme="https://yyypasserby.github.io/categories/web/"/>
    
      <category term="frontend" scheme="https://yyypasserby.github.io/categories/web/frontend/"/>
    
    
      <category term="bower" scheme="https://yyypasserby.github.io/tags/bower/"/>
    
      <category term="angular" scheme="https://yyypasserby.github.io/tags/angular/"/>
    
      <category term="npm" scheme="https://yyypasserby.github.io/tags/npm/"/>
    
      <category term="yeoman" scheme="https://yyypasserby.github.io/tags/yeoman/"/>
    
      <category term="grunt" scheme="https://yyypasserby.github.io/tags/grunt/"/>
    
  </entry>
  
  <entry>
    <title>Online Answer System for SEU History Competition</title>
    <link href="https://yyypasserby.github.io/2015/05/30/project-seu-history-angular/"/>
    <id>https://yyypasserby.github.io/2015/05/30/project-seu-history-angular/</id>
    <published>2015-05-30T18:22:33.000Z</published>
    <updated>2018-07-20T21:36:39.927Z</updated>
    
    <content type="html"><![CDATA[<ul><li>SEU-History-Angular: <a href="http://seu-history.github.io/SEU-History-Angular" target="_blank" rel="noopener">http://seu-history.github.io/SEU-History-Angular</a></li><li>Github: <a href="https://github.com/SEU-History/SEU-History-Angular" target="_blank" rel="noopener">SEU-History/SEU-History-Angular</a></li></ul><p><img src="/images/project-seu-history-angular/index.png" alt="Seu History"><br><img src="/images/project-seu-history-angular/answer-sheet.png" alt="Seu History Answer Sheets"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;ul&gt;
&lt;li&gt;SEU-History-Angular: &lt;a href=&quot;http://seu-history.github.io/SEU-History-Angular&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://seu-history.g
      
    
    </summary>
    
      <category term="project" scheme="https://yyypasserby.github.io/categories/project/"/>
    
    
      <category term="angular" scheme="https://yyypasserby.github.io/tags/angular/"/>
    
  </entry>
  
  <entry>
    <title>MinHeap-Optimized Dijkstra</title>
    <link href="https://yyypasserby.github.io/2015/04/05/minheap-optimized-dijkstra/"/>
    <id>https://yyypasserby.github.io/2015/04/05/minheap-optimized-dijkstra/</id>
    <published>2015-04-05T18:22:33.000Z</published>
    <updated>2018-07-20T21:36:39.926Z</updated>
    
    <content type="html"><![CDATA[<p>In Microsoft campus recuitment contest, there is a problem which could use <a href="http://en.wikipedia.org/wiki/Dijkstra&#39;s_algorithm" target="_blank" rel="noopener">Dijkstra shortest path algorithm</a> to solve. And I write a version whose time complexity is <strong>O(n2)</strong> in the contest, however, that makes me feel not very good. So I decide to have a good review of some basic algorithms.</p><h2 id="The-simple-version-of-Dijkstra"><a href="#The-simple-version-of-Dijkstra" class="headerlink" title="The simple version of Dijkstra"></a>The simple version of Dijkstra</h2><p>Dijkstra shortest path algorithms is the fastest single point shortest pathfinding algorithms so far. And it is very easy to program. The basic pseudo code is as follows.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Node S = the Start node</span><br><span class="line">Set M = the set contains those nodes have already find the shortest path to S</span><br><span class="line">Set N = the set contains those nodes have <span class="keyword">not</span> find the shortest path to S yet</span><br><span class="line">Array d = the current shortest path to S</span><br><span class="line">Function w(x, y) = <span class="keyword">return</span> the distance between x <span class="keyword">and</span> y</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> each i <span class="keyword">in</span> d:</span><br><span class="line">    d(i) = infinite</span><br><span class="line">d(S) = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> N <span class="keyword">is</span> <span class="keyword">not</span> empty:</span><br><span class="line">    v = Extract_min(N)</span><br><span class="line">    <span class="keyword">for</span> each node i <span class="keyword">in</span> N:</span><br><span class="line">        <span class="keyword">if</span> d(i) &gt; d(v) + w(v, i):</span><br><span class="line">            d(i) = d(v) + w(v, i)</span><br><span class="line">    add v to M</span><br></pre></td></tr></table></figure><p>So basic idea of Dijsktra is that we must find the current min value to the origin <strong>S</strong> and gradually update the value of distance from other nodes to the origin <strong>S</strong>. Actually, we find the only point that could be optimized is the function <code>Extract_min</code>. So the problem comes to how to extract a min value from an array.</p><p>In a very common style of thinking, we will consider the algorithm like this.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">function Extract_min(d):</span><br><span class="line">    v, min = infinite</span><br><span class="line">    <span class="keyword">for</span> each i <span class="keyword">in</span> d:</span><br><span class="line">        <span class="keyword">if</span> d(i) &lt; min:</span><br><span class="line">            min = d(i)</span><br><span class="line">            v = i</span><br><span class="line">    <span class="keyword">return</span> i</span><br></pre></td></tr></table></figure><p>This algorithm use the time complexity of <strong>O(n)</strong> to find a min value, is not so acceptable if the number of nodes is large. In fact, we really know a way to optimize this operation, that is a <strong>heap</strong>.</p><p>Heap is a kind of data structure that can get the min/max element of a set of things. The time complexity of pop/push an element is <strong>O(logn)</strong> is a good optimization compare to the sequential compare. In <strong>C++</strong>, there are also some useful functions to implement the operations.</p><p>In <strong>C++</strong>, there is no a practical data structure named <strong>heap</strong>, like <code>vector</code>, <code>set</code> or <code>unordered_map</code>. However, something related to the max heap named priority queue is an <strong>STL</strong> container. So how are the heap implemented? See the following functions.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">make_heap(<span class="built_in">vector</span>&lt;T&gt;::iterator begin, <span class="built_in">vector</span>&lt;T&gt;::iterator end);</span><br><span class="line">push_heap(<span class="built_in">vector</span>&lt;T&gt;::iterator begin, <span class="built_in">vector</span>&lt;T&gt;::iterator end);</span><br><span class="line">pop_heap(<span class="built_in">vector</span>&lt;T&gt;::iterator begin, <span class="built_in">vector</span>&lt;T&gt;::iterator end);</span><br></pre></td></tr></table></figure><p>These three functions is all we need to implement a heap. The three functions also can accept another parameter named <strong>Compare</strong>, which determines two problems, max or min and which attributes are to compare. And this function is very important for us to customized the STL function so that we could use heap to optimize Dijkstra algorithm.</p><h2 id="Minheap-Optimized-Dijkstra"><a href="#Minheap-Optimized-Dijkstra" class="headerlink" title="Minheap-Optimized Dijkstra"></a>Minheap-Optimized Dijkstra</h2><p>Ok, let’s just start to optimized the <code>Extract_min</code> function.</p><p>First, we also need to initialize a <strong>vector</strong>, which contains the distance of every nodes from the origin S.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">vector</span>&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt; d;</span><br><span class="line">d.resize(node_size + <span class="number">1</span>, make_pair(<span class="number">0</span>, INT_MAX));</span><br><span class="line"><span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> &amp;kv : d) &#123;</span><br><span class="line">    k.first = ++cnt;</span><br><span class="line">&#125;</span><br><span class="line">d[begin].second = <span class="number">0</span>;</span><br></pre></td></tr></table></figure><p>We use the index to represent the nodes index in the graph which begins from 1. And the first node extracted from the node set must be the origin <strong>S</strong> itself. So we change the value of <strong>S</strong> in <strong>d</strong> to <strong>ZERO</strong>.</p><p>Second, we need a loop to find if there are still things in the <strong>Set N</strong>, and also to <code>Extract_min</code> from the set of number.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>(!d.empty()) &#123;</span><br><span class="line">    make_heap(d.begin(), d.end(), dijkstra_min_heap);</span><br><span class="line">    pop_heap(d.begin(), d.end(), dijkstra_min_heap);</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>These two key statements are to optimized the <code>Extract_min</code> function, the <code>pop_heap</code> function will put the min or max element to the end of the vector, so we just need to get the element from the vector’s back. And <code>dijkstra_min_heap</code> is just as follow.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">dijkstra_min_heap</span><span class="params">(<span class="keyword">const</span> pii &amp;a, <span class="keyword">const</span> pii &amp;b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a.second &gt; b.second;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>So, when we use the <strong>STL</strong>, it is easy for us to implement some algorithms fast and accurate.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;In Microsoft campus recuitment contest, there is a problem which could use &lt;a href=&quot;http://en.wikipedia.org/wiki/Dijkstra&amp;#39;s_algorithm
      
    
    </summary>
    
      <category term="practice" scheme="https://yyypasserby.github.io/categories/practice/"/>
    
    
      <category term="algorithm" scheme="https://yyypasserby.github.io/tags/algorithm/"/>
    
  </entry>
  
  <entry>
    <title>Compiler Lab</title>
    <link href="https://yyypasserby.github.io/2015/03/17/project-compiler-lab/"/>
    <id>https://yyypasserby.github.io/2015/03/17/project-compiler-lab/</id>
    <published>2015-03-17T18:22:33.000Z</published>
    <updated>2018-07-20T21:36:39.927Z</updated>
    
    <content type="html"><![CDATA[<ul><li>Compiler-lab: <a href="http://compiler-lab.herokuapp.com/" target="_blank" rel="noopener">http://compiler-lab.herokuapp.com/</a></li><li>Github: <a href="https://github.com/yyypasserby/lexical_analysis_visualization" target="_blank" rel="noopener">yyypasserby/lexical_analysis_visualization</a></li></ul><p><img src="/images/project-compiler-lab/index.png" alt="Compiler Lab"></p><p><img src="/images/project-compiler-lab/charts.png" alt="Compiler Lab Charts"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;ul&gt;
&lt;li&gt;Compiler-lab: &lt;a href=&quot;http://compiler-lab.herokuapp.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://compiler-lab.herokuapp.com/&lt;/a&gt;&lt;/l
      
    
    </summary>
    
      <category term="project" scheme="https://yyypasserby.github.io/categories/project/"/>
    
    
      <category term="compiler" scheme="https://yyypasserby.github.io/tags/compiler/"/>
    
  </entry>
  
  <entry>
    <title>Online Bookshop</title>
    <link href="https://yyypasserby.github.io/2015/03/17/project-online-bookshop/"/>
    <id>https://yyypasserby.github.io/2015/03/17/project-online-bookshop/</id>
    <published>2015-03-17T18:22:33.000Z</published>
    <updated>2018-07-20T21:36:39.927Z</updated>
    
    <content type="html"><![CDATA[<ul><li>Online Bookshop: <a href="https://online-bookshop.herokuapp.com/" target="_blank" rel="noopener">https://online-bookshop.herokuapp.com/</a></li><li>Github: <a href="https://github.com/yyypasserby/OnlineBookshop" target="_blank" rel="noopener">yyypasserby/OnlineBookshop</a></li></ul><p><img src="/images/project-online-bookshop/index.png" alt="Online Bookshop"></p><p><img src="/images/project-online-bookshop/accounts.png" alt="Online Bookshop Accounts"></p><p><img src="/images/project-online-bookshop/comments.png" alt="Online Bookshop Comments"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;ul&gt;
&lt;li&gt;Online Bookshop: &lt;a href=&quot;https://online-bookshop.herokuapp.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://online-bookshop.herokuapp.
      
    
    </summary>
    
      <category term="project" scheme="https://yyypasserby.github.io/categories/project/"/>
    
    
      <category term="django" scheme="https://yyypasserby.github.io/tags/django/"/>
    
  </entry>
  
  <entry>
    <title>Deploying Django 1.7 to Heroku</title>
    <link href="https://yyypasserby.github.io/2014/12/21/django-on-heroku/"/>
    <id>https://yyypasserby.github.io/2014/12/21/django-on-heroku/</id>
    <published>2014-12-21T19:22:33.000Z</published>
    <updated>2018-07-20T21:36:39.926Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/django-on-heroku/django.png" alt="Django"></p><p><a href="https://www.djangoproject.com/" target="_blank" rel="noopener">Django 1.7</a> has been long released and its new features of migrations make our web development much easier when dealing with DBs.</p><p><a href="https://www.heroku.com/" target="_blank" rel="noopener">Heroku</a> is a PaaS that managed by <a href="http://www.git-scm.com/" target="_blank" rel="noopener">git</a> and supports Django. If you are a man that don’t want to spend any money on your website like me. I think Heroku is somewhat a good choice for you.</p><p>I used to deploy my website on <a href="https://www.openshift.com/" target="_blank" rel="noopener">Openshift</a> provided by redhat-cloud, however it sometimes was blocked by the GFW. The service of Openshift is great but considering the difficulty of maintainence, I gave up and turn to Heroku.</p><p>But all these PaaS has some several common nature:</p><ul><li><p>need to obey its permission on files, you could not easily customized your web app in some particular ways.</p></li><li><p>need to obey the ways that settings given by the PaaS provider. You should install the local deploy tools to make your web app works find on your localhost. Sometimes if you don’t obey the rules, your app won’t work</p></li><li><p>free service is often with slow reponse and unstablility.</p></li></ul><p>For the reason above, the PaaS service is recommended to deploy some simple and regualr web app with limited functions, such as some frameworks demo, some homework presentation and etc.</p><h2 id="Prerequisites"><a href="#Prerequisites" class="headerlink" title="Prerequisites"></a>Prerequisites</h2><p>The setups of Django project is demonstrated in this <a href="{filename}/2014-12-18-django-and-bower.md">blog</a>.</p><p>So after the creation of a project is done. Your project is maybe just like this.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">hellodjango</span><br><span class="line">├── hellodjango</span><br><span class="line">│   ├── __init__.py</span><br><span class="line">│   ├── settings.py</span><br><span class="line">│   ├── urls.py</span><br><span class="line">│   ├── wsgi.py</span><br><span class="line">├── manage.py</span><br><span class="line">└── venv</span><br></pre></td></tr></table></figure><p>With the instruction given by the <a href="https://devcenter.heroku.com/articles/getting-started-with-django" target="_blank" rel="noopener">Documentation</a>, we know that the Heroku platform need us to do some extra things to deploy your app.</p><p><strong>First</strong>,  your need to install <a href="https://devcenter.heroku.com/articles/getting-started-with-python#set-up" target="_blank" rel="noopener">Heroku-toolbelt</a>, this contains <code>heroku</code> command to operate and show logs of your project.</p><p><strong>Second</strong>, the default database of Heroku is <strong>Postgresql</strong>, so your need to install <a href="http://postgresapp.com/" target="_blank" rel="noopener">Postgres.app</a> to your computer. I strongly recommend the Mac user to choose the app provided by the official website which could save your a lot of time.</p><p><strong>Thirdly</strong>, especially for Django, you need to install the <a href="https://pypi.python.org/pypi/django-toolbelt/0.0.1" target="_blank" rel="noopener">django-toolbelt</a> to make your website work on Heroku in production state. I found the main thing that django-toolbelt has done is to deal with the static file, like css, js, image and etc. In <a href="https://docs.djangoproject.com/en/1.7/" target="_blank" rel="noopener">documentation</a> of Django, it is not recommended that to use staticfile serve provided by Django for some particular reasons including security. To install django-toolbelt easily, you can type the following command when you are in <strong>virtualenv</strong> mode</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install django-toolbelt</span><br></pre></td></tr></table></figure><p>If you encounter some problems like <code>could not find pg_config executable</code>, that means your Postgresql is not properly configured. You should add the <code>pg_config</code> into your environment variable. It is here if you use the <strong>Postgres.app</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/Applications/Postgres.app/Contents/Versions/9.4/bin</span><br></pre></td></tr></table></figure><h2 id="Configure-Heroku"><a href="#Configure-Heroku" class="headerlink" title="Configure Heroku"></a>Configure Heroku</h2><p>After you have done all these, we can start to configure something required by the Heroku to make your app running on the remote.</p><h3 id="Procfile"><a href="#Procfile" class="headerlink" title="Procfile"></a>Procfile</h3><p>Procfile is used to configure the web container used to run <strong>WSGI</strong> application. The content is like</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">web: gunicorn &lt;project_name&gt;.wsgi --log-file -</span><br></pre></td></tr></table></figure><p>Now you can type</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">foreman start</span><br></pre></td></tr></table></figure><p>to check if your app is running well in the local environment.</p><h3 id="requirements-txt"><a href="#requirements-txt" class="headerlink" title="requirements.txt"></a>requirements.txt</h3><p>This file is used for Heroku to install the dependency for your python web app. After you push your file up to the Heroku server, it will execute</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install -r requirements.txt</span><br></pre></td></tr></table></figure><p>to install the dependencies. So what we need to do is</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip freeze &gt; requirements.txt</span><br></pre></td></tr></table></figure><h3 id="Django-settings"><a href="#Django-settings" class="headerlink" title="Django settings"></a>Django settings</h3><p>There are also something we need to modify in our Django project.</p><p><strong>settings.py</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Parse database configuration from $DATABASE_URL</span></span><br><span class="line"><span class="keyword">import</span> dj_database_url</span><br><span class="line">DATABASES[<span class="string">'default'</span>] = dj_database_url.config()</span><br><span class="line"><span class="comment"># Honor the 'X-Forwarded-Proto' header for request.is_secure()</span></span><br><span class="line">SECURE_PROXY_SSL_HEADER = (<span class="string">'HTTP_X_FORWARDED_PROTO'</span>, <span class="string">'https'</span>)</span><br><span class="line"><span class="comment"># Allow all host headers</span></span><br><span class="line">ALLOWED_HOSTS = [<span class="string">'*'</span>]</span><br><span class="line"><span class="comment"># Static asset configuration</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="comment"># Not essential because the settings.py in Django 1.7 has already </span></span><br><span class="line"><span class="comment"># provided the definition of BASE_DIR and that seems to be more correct</span></span><br><span class="line"><span class="comment"># BASE_DIR = os.path.dirname(os.path.abspath(__file__))</span></span><br><span class="line">STATIC_ROOT = <span class="string">'staticfiles'</span></span><br><span class="line">STATIC_URL = <span class="string">'/static/'</span></span><br><span class="line">STATICFILES_DIRS = (</span><br><span class="line">    os.path.join(BASE_DIR, <span class="string">'static'</span>),</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><strong>wsgi.py</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.core.wsgi <span class="keyword">import</span> get_wsgi_application</span><br><span class="line"><span class="keyword">from</span> dj_static <span class="keyword">import</span> Cling</span><br><span class="line"></span><br><span class="line">application = Cling(get_wsgi_application())</span><br></pre></td></tr></table></figure><h2 id="Deploy-to-Heroku"><a href="#Deploy-to-Heroku" class="headerlink" title="Deploy to Heroku"></a>Deploy to Heroku</h2><p>Now your file structure is like</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">hellodjango</span><br><span class="line">├── Procfile</span><br><span class="line">├── hellodjango</span><br><span class="line">├── manage.py</span><br><span class="line">├── requirements.txt</span><br><span class="line">└── venv</span><br></pre></td></tr></table></figure><p>We know that Heroku use git to manage the file upload, so the first thing to do is to initiate a git repo and make all the things done committed to the repo.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git init</span><br><span class="line">git add .</span><br><span class="line">git commit -m<span class="string">'init commit'</span></span><br></pre></td></tr></table></figure><p>The <code>.gitignore</code> file could contain these several lines.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">venv/</span><br><span class="line">*.pyc</span><br><span class="line">staticfiles/</span><br></pre></td></tr></table></figure><p>After the repo is set up, we shall create a heroku repo and add its url to our git remote repo. All these operation is encapsulated in one command.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">heroku create</span><br></pre></td></tr></table></figure><p>If you are the first time to use <strong>heroku-toolbelt</strong>, you had better login first</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">heroku login</span><br></pre></td></tr></table></figure><p>Input your account and password according to the info.</p><p>Then you need to push your repo to the master branch of the remote repo in Heroku.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push heroku master</span><br></pre></td></tr></table></figure><p>Then, after Heroku make a the remote environment set up, you can now visit your website using <code>heroku open</code> and try to rename it using <code>heroku apps:rename &lt;new_app_name&gt;</code>.</p><p>There are also many useful commands to control your website, to see more detailed information, please see the <a href="https://devcenter.heroku.com/articles/getting-started-with-python" target="_blank" rel="noopener">Documentation</a>.</p><h2 id="Suggestion"><a href="#Suggestion" class="headerlink" title="Suggestion"></a>Suggestion</h2><h3 id="Automatically-config-environment"><a href="#Automatically-config-environment" class="headerlink" title="Automatically config environment"></a>Automatically config environment</h3><p>The modification in <strong>settings.py</strong> may make your local debugging not performing right. So I added something more to make the changes just work in the remote.</p><ol><li><p>Create a file naming <code>.env</code>, and type these</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ENV=LOCAL</span><br></pre></td></tr></table></figure></li><li><p>Add one line before the modification and the final content shall be</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="string">'LOCAL'</span> != os.environ.get(<span class="string">'ENV'</span>, <span class="string">'HEROKU'</span>):</span><br><span class="line"><span class="comment"># Parse database configuration from $DATABASE_URL</span></span><br><span class="line">   <span class="keyword">import</span> dj_database_url</span><br><span class="line">   DATABASES[<span class="string">'default'</span>] = dj_database_url.config()</span><br><span class="line">   ...</span><br></pre></td></tr></table></figure></li><li><p>Config the remote environment variable, type the following command under your app root folder</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">heroku config:<span class="built_in">set</span> ENV=HEROKU</span><br></pre></td></tr></table></figure></li></ol><p>These operation just add an environment variable to the development env and production env and make the app itself to detect the environment changes.</p><h3 id="Use-the-Django-admin"><a href="#Use-the-Django-admin" class="headerlink" title="Use the Django admin"></a>Use the Django admin</h3><p>As we all know <strong>Django admin</strong> is a very useful module to give the developer a full view of his app. To activate this feature, we should do the following two things.</p><ol><li><p>Configure the static files properly and include the related apps and middlewares in the corresponding settings.</p></li><li><p>Create a superuser of the remote app. Heroku provide us a way to execute instructions to the remote user. Just like,</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">heroku run python manage.py createsuperuser</span><br></pre></td></tr></table></figure><p>Then it will be instruct you to create a superuser interactively like you just do locally.</p><p>You know can visit the <code>&lt;app_url&gt;/admin</code> to operate your remote database happily.</p></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;/images/django-on-heroku/django.png&quot; alt=&quot;Django&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.djangoproject.com/&quot; target=&quot;_blank&quot; rel=&quot;noopene
      
    
    </summary>
    
      <category term="web" scheme="https://yyypasserby.github.io/categories/web/"/>
    
      <category term="backend" scheme="https://yyypasserby.github.io/categories/web/backend/"/>
    
    
      <category term="django" scheme="https://yyypasserby.github.io/tags/django/"/>
    
      <category term="deploy" scheme="https://yyypasserby.github.io/tags/deploy/"/>
    
  </entry>
  
  <entry>
    <title>Practices on Django &amp; Bower</title>
    <link href="https://yyypasserby.github.io/2014/12/18/django-and-bower/"/>
    <id>https://yyypasserby.github.io/2014/12/18/django-and-bower/</id>
    <published>2014-12-18T19:22:33.000Z</published>
    <updated>2018-07-20T21:36:39.926Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/django-and-bower/django.png" alt="Django"></p><p>As a front-end developer, most of you may know <a href="http://bower.io" target="_blank" rel="noopener">bower</a> these days. Bower is a powerful tools to make your front-end more modular and easy to manage.</p><p>And <a href="https://www.djangoproject.com/" target="_blank" rel="noopener">Django</a> is also very popular in the back-end deveopment. <a href="http://www.douban.com/" target="_blank" rel="noopener">Douban</a>, <a href="http://www.zhihu.com/" target="_blank" rel="noopener">Zhihu</a> all uses Django as their backend framework.</p><p>Today, I am just going to talk about something I concluded from my project in cooperate Django and bower and they really make my website dev much more convenient.</p><h2 id="Virtualenv"><a href="#Virtualenv" class="headerlink" title="Virtualenv"></a>Virtualenv</h2><p>This tool is always used in many python project. Python is undoubtedly a great language with diversity, but it also encounter many problems as its diversity. We may frequently find some package conflicts with each other, that is because the package is design by different people, they won’t communicate with each other until facing conflict. So usually we use the <a href="https://virtualenv.pypa.io/" target="_blank" rel="noopener">virtualenv</a> to avoid these uncompatible problems as much as we can. After you set up your <a href="https://pypi.python.org/pypi/setuptools" target="_blank" rel="noopener">setuptools</a> and <a href="https://pypi.python.org/pypi/pip/" target="_blank" rel="noopener">pip</a>, you can easily get virtualenv by</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install virtualenv</span><br></pre></td></tr></table></figure><p>After installing virtualenv, you can set up a individual virtual environment for your project.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">virtualenv env</span><br><span class="line"><span class="built_in">source</span> env/bin/activate</span><br></pre></td></tr></table></figure><p>And all the things you doing after is just change the environment in a virtual way, it won’t conflict with your other packages if they are not in the same environment. To my own point of view, I will start up a brand new environment for a new project even some of its dependency overlaps with my project before. You could also use the same virtual env when doing all your Django project. It’s all up to you.</p><h2 id="Django"><a href="#Django" class="headerlink" title="Django"></a>Django</h2><p>You can install Django in your virtual environment now. </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install django</span><br></pre></td></tr></table></figure><p>The lastest version of Django is 1.7, and its has a great update in 1.7 about the model operation. It has merge the function of <a href="http://south.aeracode.org/" target="_blank" rel="noopener">south</a> project into it and make the modification of the models more convenient. This feature still has some improvements. The process is a little bit different when we build our tables. In the former versions, we do something like following</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># app/models.py</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Books</span><span class="params">(models.Model)</span>:</span></span><br><span class="line">    name = models.TextFields()</span><br><span class="line"></span><br><span class="line"><span class="comment"># project/settings.py</span></span><br><span class="line">INSTALLED_APPS = (</span><br><span class="line">    ...</span><br><span class="line">    <span class="string">'app'</span>,</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>And do these in the command</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py syncdb</span><br></pre></td></tr></table></figure><p>And all your models will sync to your databases.<br><strong>But now in 1.7</strong>, we will have something more to do, <strong>instead of the command above.</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py makemigrations app</span><br></pre></td></tr></table></figure><p>First we should make the migrations of the app and records them in the <code>migration</code> folder. The structure is just like the following</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">migrations</span><br><span class="line">├── 0001_initial.py</span><br><span class="line">├── 0001_initial.pyc</span><br><span class="line">├── __init__.py</span><br><span class="line">└── __init__.pyc</span><br></pre></td></tr></table></figure><p>The file produced by this step is to make a image of this version and Django could identify the future changes by comparison with this image.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py migrate app</span><br></pre></td></tr></table></figure><p>The operation is just like the <code>syncdb</code> in the former version. The models are created in the databases.</p><p>If you are using <a href="http://sqlite.org/" target="_blank" rel="noopener">sqlite3</a>, you can use <code>.tables</code> command to show all the tables in your databases.</p><h2 id="Bower"><a href="#Bower" class="headerlink" title="Bower"></a>Bower</h2><p>To my personal custom, in some small projects, I would like to make my utils static files that used in all apps in a folder in the root level. Just like</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">├── db.sqlite3</span><br><span class="line">├── app</span><br><span class="line">├── manage.py</span><br><span class="line">├── static</span><br><span class="line">├── template</span><br><span class="line">└── project</span><br></pre></td></tr></table></figure><p>This static folder is used to store bower repository for me.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> static</span><br><span class="line">bower init</span><br></pre></td></tr></table></figure><p>Then you can install any front-end framework as you want. To me, these three framework is necessary,</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bower install requirejs --save</span><br><span class="line">bower install bootstrap --save</span><br><span class="line">bower install jquery --save</span><br></pre></td></tr></table></figure><p>After installed these packages, we could use either <code>&lt;script&gt;</code> ways or <code>rejuirejs</code> ways to include them in our django templates. I’m just going to show you the basic way.</p><p>Django has several ways to deal with static files. <code>STATIC_ROOT</code> and <code>STATICFILES_DIRS</code> are two stantard methods. When we use static file, we must ensure an app is activated in <code>INSTALLED_APPS</code>.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS = (</span><br><span class="line">    <span class="string">'django.contrib.staticfiles'</span>,</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>I prefer to store all my dependency in a global static folder, so I just need to add</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># project/settings.py</span></span><br><span class="line">STATICFILES_DIRS = (</span><br><span class="line">    os.path.join(BASE_DIR, <span class="string">'static'</span>),</span><br><span class="line">)</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--templates/index.html--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    &#123;% raw %&#125;&#123;% load staticfiles %&#125;&#123;% endraw %&#125;</span><br><span class="line">    &#123;% raw %&#125;<span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"&#123;% static "</span><span class="attr">bower_components</span>/<span class="attr">path</span>/<span class="attr">to</span>/<span class="attr">staticfiles</span>" %&#125;"&gt;</span>&#123;% endraw %&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Then the engine could find these static files for me.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;/images/django-and-bower/django.png&quot; alt=&quot;Django&quot;&gt;&lt;/p&gt;
&lt;p&gt;As a front-end developer, most of you may know &lt;a href=&quot;http://bower.
      
    
    </summary>
    
      <category term="web" scheme="https://yyypasserby.github.io/categories/web/"/>
    
    
      <category term="django" scheme="https://yyypasserby.github.io/tags/django/"/>
    
      <category term="bower" scheme="https://yyypasserby.github.io/tags/bower/"/>
    
  </entry>
  
  <entry>
    <title>OpenCV settings on Mac</title>
    <link href="https://yyypasserby.github.io/2014/11/24/opencv-settings-on-mac/"/>
    <id>https://yyypasserby.github.io/2014/11/24/opencv-settings-on-mac/</id>
    <published>2014-11-24T19:22:33.000Z</published>
    <updated>2018-07-20T21:36:39.927Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Install-homebrew"><a href="#Install-homebrew" class="headerlink" title="Install homebrew"></a>Install homebrew</h2><p>Type the following directions to install <strong>homebrew</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ruby -e <span class="string">"<span class="variable">$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)</span>"</span></span><br></pre></td></tr></table></figure><h2 id="Install-OpenCV"><a href="#Install-OpenCV" class="headerlink" title="Install OpenCV"></a>Install OpenCV</h2><p>After installing homebrew, we just need to type the following direction to install <strong>OpenCV</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install opencv</span><br></pre></td></tr></table></figure><p>It will not always works well. There may be kind of mistakes and I just encounter the such in the process. I just could not finish the installation of <strong>libpng</strong>, and I found that it was prevented by the man’s trigger. The file <code>man5</code> has been already allocated by other programs with the permission <strong>admin</strong>, so I used <code>sudo chown $USER man5</code> to solve this problem. And then I went on with the instruction of <code>brew link libpng</code>.</p><p>Here, OpenCV has already been installed.</p><h2 id="Settings-and-make-a-demo"><a href="#Settings-and-make-a-demo" class="headerlink" title="Settings and make a demo"></a>Settings and make a demo</h2><p>Now All the dylibs is in /usr/local/lib, we need add them to our projects.</p><ol><li>New a command line project in Xcode</li><li><p>Select the <strong>Project</strong> and choose <strong>Add Files to …</strong></p><p><img src="/images/opencv-settings-on-mac/addFiles.png" alt="Step 2"></p></li><li><p><code>Command + Shift + G</code> to type the directory of our dylibs as above <code>/usr/local/lib</code>.</p><p><img src="/images/opencv-settings-on-mac/addLibs.png" alt="Step 3"></p></li><li><p>Choose all the dylibs under this directory and click <strong>Add</strong>.</p></li><li><p>Click the settings and choose <strong>Target</strong>, select <strong>All</strong> option on the right side and type <strong>Header Search Path</strong> in the search. Add these two lines in the section.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/include</span><br><span class="line">/usr/local/include/opencv</span><br></pre></td></tr></table></figure></li><li><p>Add <code>/usr/local/lib</code> to the <strong>Library Search Path</strong></p></li><li>Try the following code in your <code>main.cpp</code>, see how it works!</li></ol><figure class="highlight cc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;opencv2/highgui/highgui.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;opencv/cvaux.hpp&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">VideoCapture <span class="title">cap</span><span class="params">(<span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="keyword">if</span>(!cap.isOpened()) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Mat edges;</span><br><span class="line">    namedWindow(<span class="string">"Source"</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(;;) &#123;</span><br><span class="line">        Mat frame;</span><br><span class="line">        cap &gt;&gt; frame;</span><br><span class="line">        <span class="comment">//resize(frame, frame, Size(320, 320));</span></span><br><span class="line">        pyrDown(frame, frame);</span><br><span class="line">        cvtColor(frame, frame, CV_BGR2GRAY);</span><br><span class="line">        GaussianBlur(frame, frame, Size(<span class="number">7</span>, <span class="number">7</span>), <span class="number">1.5</span>, <span class="number">1.5</span>);</span><br><span class="line">        imshow(<span class="string">"Source"</span>, frame);</span><br><span class="line">        <span class="keyword">if</span>(waitKey(<span class="number">30</span>) &gt;= <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;Install-homebrew&quot;&gt;&lt;a href=&quot;#Install-homebrew&quot; class=&quot;headerlink&quot; title=&quot;Install homebrew&quot;&gt;&lt;/a&gt;Install homebrew&lt;/h2&gt;&lt;p&gt;Type the follo
      
    
    </summary>
    
      <category term="setup" scheme="https://yyypasserby.github.io/categories/setup/"/>
    
    
      <category term="opencv" scheme="https://yyypasserby.github.io/tags/opencv/"/>
    
  </entry>
  
</feed>
